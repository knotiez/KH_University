<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "mybatis-3-mapper.dtd" >
<mapper namespace="studentMapper">

	<resultMap type="Student" id="studentResult">
		<result column="student_no" property="studentNo"/>
		<result column="student_id" property="studentId"/>
		<result column="student_pwd" property="studentPwd"/>
		<result column="student_name" property="studentName"/>
		<result column="student_ssn" property="studentSsn"/>
		<result column="s_phone" property="stPhone"/>
		<result column="s_email" property="stEmail"/>
		<result column="a_address" property="stAddress"/>
		<result column="s_status" property="stStatus"/>
		<result column="enroll_date" property="enrollDate"/>
		<result column="absence_date" property="absenceDate"/>
		<result column="grad_date" property="gradDate"/>
	</resultMap>

	<select id="loginStudent" resultMap="studentResult">
		select 
	       student_no
	     , student_id
	     , student_pwd
	     , student_name
	     , student_ssn
	     , s_phone
	     , s_email
	     , s_address
	     , enroll_date
	     , absence_date
	     , grad_date
	  from student
	 where student_id = #{studentId}
	   and s_status = 'Y'
	</select>

	<select id="selectChkStudent" resultMap="studentResult">
		select 
		       *
		  from student
		 where s_email = #{email}
	</select>

	<update id="changePwd" parameterType="map">
	    update student
	    set student_pwd = #{userPwd}
	    where student_id = #{studentId}
	</update>

	<insert id="insertStudent">
		insert
		  into student
		     (
		       student_no
		     , student_id
		     , student_pwd
		     , student_name
		     , student_ssn
		     , s_phone
		     , s_email
		     , s_address
		     )
		values
		     (
		       seq_mno.nextval
		     , 'kh'||to_char(sysdate, 'yy')||to_char(seq_user_no.nextval, 'FM0000')
		     , #{studentPwd}
		     , #{studentName}
		     , #{studentSsn}
		     , #{stPhone}
		     , #{stEmail}
		     , #{stAddress}
		     )
	</insert>

	<select id="selectStudentId" resultType="String">
		select
		       student_id
		  from student
		 where s_email = #{stEmail}     
	</select>
	
		<select id="verifyEmail" resultType="_int">
		select
		       count(*)
		  from student
		 where s_email = #{email}      
	</select>

</mapper>